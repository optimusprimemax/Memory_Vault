<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Zombie Runner</title>
<style>
    * {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }
    body {
        background: #87ceeb;
        touch-action: manipulation; /* improve mobile touch response */
    }
    canvas {
        display: block;
    }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// -------------------- GAME VARIABLES --------------------
let GROUND_Y = 0;
let gameSpeed = 6;
let gravity = 0.5;
let gameOver = false;
let score = 0;
let frame = 0;

// -------------------- RESIZE --------------------
function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    GROUND_Y = canvas.height - 90;

    // Keep player on ground and near left edge
    player.x = canvas.width * 0.05;
    player.y = GROUND_Y - player.height;
}
window.addEventListener("resize", resizeCanvas);

// -------------------- IMAGES --------------------
const charImg = new Image();
charImg.src = "char.png";

const zombieImg = new Image();
zombieImg.src = "zombie.png";

const heartImg = new Image();
heartImg.src = "heart.png";

// -------------------- PLAYER --------------------
const player = {
    x: 0,  // will be set on resize
    y: 0,
    width: 150,
    height: 150,
    velocityY: 0,
    jump() {
        if (this.y >= GROUND_Y - this.height) {
            this.velocityY = -18;
        }
    },
    update() {
        this.velocityY += gravity;
        this.y += this.velocityY;

        if (this.y > GROUND_Y - this.height) {
            this.y = GROUND_Y - this.height;
            this.velocityY = 0;
        }
    },
    draw() {
        ctx.drawImage(charImg, this.x, this.y, this.width, this.height);
    }
};

// -------------------- OBSTACLES --------------------
let obstacles = [];
function spawnObstacle() {
    const size = 90;
    obstacles.push({
        x: canvas.width,
        y: GROUND_Y - size,
        width: 70,
        height: 70
    });
}

// -------------------- HEARTS --------------------
let hearts = [];
function spawnHeart(x) {
    hearts.push({
        x: x,
        y: GROUND_Y - 45,
        width: 45,
        height: 45
    });
}

// -------------------- CLOUDS --------------------
let clouds = [];
function spawnCloud() {
    clouds.push({
        x: canvas.width,
        y: Math.random() * 200 + 50,
        size: Math.random() * 40 + 40,
        speed: gameSpeed * 0.3
    });
}

// -------------------- CONTROLS --------------------
document.addEventListener("keydown", e => {
    if (e.code === "Space") {
        if (gameOver) location.reload();
        player.jump();
    }
});

document.addEventListener("click", () => {
    if (gameOver) location.reload();
    player.jump();
});

// -------------------- COLLISION --------------------
function collide(a, b) {
    return (
        a.x < b.x + b.width &&
        a.x + a.width > b.x &&
        a.y < b.y + b.height &&
        a.y + a.height > b.y
    );
}

// -------------------- GAME LOOP --------------------
function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Sky
    ctx.fillStyle = "#87ceeb";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Clouds
    if (frame % 150 === 0) spawnCloud();
    clouds.forEach((c, i) => {
        c.x -= c.speed;
        ctx.fillStyle = "rgba(255,255,255,0.9)";
        ctx.beginPath();
        ctx.arc(c.x, c.y, c.size, 0, Math.PI * 2);
        ctx.arc(c.x + 30, c.y + 10, c.size - 10, 0, Math.PI * 2);
        ctx.arc(c.x - 30, c.y + 10, c.size - 10, 0, Math.PI * 2);
        ctx.fill();
        if (c.x + c.size < 0) clouds.splice(i, 1);
    });

    // Ground
    ctx.fillStyle = "#444";
    ctx.fillRect(0, GROUND_Y, canvas.width, 6);

    if (!gameOver) {
        frame++;

        player.update();
        player.draw();

        if (frame % 120 === 0) {
            spawnObstacle();
            if (Math.random() > 0.6) spawnHeart(canvas.width + 120);
        }

        // Obstacles
        obstacles.forEach((o, i) => {
            o.x -= gameSpeed;
            ctx.drawImage(zombieImg, o.x, o.y, o.width, o.height);
            if (collide(player, o)) gameOver = true;
            if (o.x + o.width < 0) obstacles.splice(i, 1);
        });

        // Hearts
        hearts.forEach((h, i) => {
            h.x -= gameSpeed;
            ctx.drawImage(heartImg, h.x, h.y, h.width, h.height);
            if (collide(player, h)) {
                score++;
                hearts.splice(i, 1);
            }
            if (h.x + h.width < 0) hearts.splice(i, 1);
        });

        // Score
        ctx.fillStyle = "#000";
        ctx.font = "28px Arial";
        ctx.fillText("❤️ " + score, 30, 40);

    } else {
        ctx.fillStyle = "#000";
        ctx.textAlign = "center";
        ctx.font = "56px Arial";
        ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
        ctx.font = "26px Arial";
        ctx.fillText("Press Space or Click to Restart", canvas.width / 2, canvas.height / 2 + 45);
    }

    requestAnimationFrame(animate);
}

// -------------------- START GAME --------------------
resizeCanvas();
animate();
</script>

</body>
</html>
